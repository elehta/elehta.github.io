<style>
    :root {
        --slate-900: #0f172a;
        --slate-800: #1e293b;
        --slate-700: #334155;
        --accent: #38bdf8;
        --text-main: #f8fafc;
        --text-dim: #94a3b8;
        --border: #475569;
    }

    .dpp-spec-sheet {
        max-width: 900px;
        margin: 40px auto;
        background: var(--slate-900);
        color: var(--text-main);
        font-family: 'Inter', system-ui, -apple-system, sans-serif;
        display: grid;
        grid-template-columns: repeat(12, 1fr);
        border: 2px solid var(--border);
        gap: 0; /* Pure grid lines created by borders */
    }

    /* Grid Cell Base */
    .cell {
        padding: 20px;
        border: 1px solid var(--border);
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .label {
        font-size: 0.65rem;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: var(--accent);
        margin-bottom: 8px;
    }

    .value { font-size: 1rem; font-weight: 500; }
    .value-lg { font-size: 1.75rem; font-weight: 800; line-height: 1.1; }

    /* Layout Spans */
    .span-12 { grid-column: span 12; }
    .span-8 { grid-column: span 8; }
    .span-6 { grid-column: span 6; }
    .span-4 { grid-column: span 4; }
    .span-3 { grid-column: span 3; }

    /* Specific Sections */
    .header-cell { background: var(--slate-800); border-bottom: 4px solid var(--accent); }
    .image-cell { background: white; padding: 0; display: flex; align-items: center; justify-content: center; overflow: hidden; }
    .image-cell img { width: 100%; height: 100%; object-fit: contain; }

    .id-mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-size: 0.7rem; color: var(--text-dim); }

    /* Table Logic inside cells */
    .mini-list { list-style: none; padding: 0; margin: 0; font-size: 0.85rem; }
    .mini-list li { display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }

    .status-badge {
        font-size: 0.6rem;
        padding: 2px 6px;
        border-radius: 3px;
        font-weight: 900;
        background: var(--slate-700);
    }
    .pass { color: #4ade80; border: 1px solid #4ade80; }
    .fail { color: #f87171; border: 1px solid #f87171; }

</style>

<div class="dpp-spec-sheet">
    <div class="cell span-8 header-cell">
        <span class="label">Manufacturer // {{credentialSubject.producedByParty.name}}</span>
        <div class="value-lg">{{credentialSubject.name}}</div>
    </div>
    <div class="cell span-4 header-cell">
        <span class="label">Passport ID</span>
        <div class="id-mono" title="{{credentialSubject.id}}">{{credentialSubject.id}}</div>
    </div>

    <div class="cell span-4 image-cell">
        <img src="{{#if credentialSubject.productImage.linkURL}}{{credentialSubject.productImage.linkURL}}{{else}}https://placehold.co/400x400/1e293b/white?text=No+Image{{/if}}">
    </div>
    
    <div class="cell span-4">
        <span class="label">Physical Dimensions</span>
        <ul class="mini-list">
            {{#each credentialSubject.dimensions}}
            <li><span style="color:var(--text-dim)">{{@key}}</span> <span>{{this.value}} {{this.unit}}</span></li>
            {{/each}}
        </ul>
    </div>

    <div class="cell span-4">
        <span class="label">Manufacturing Logistics</span>
        <div class="value" style="font-size: 0.9rem;">{{credentialSubject.producedAtFacility.name}}</div>
        <div class="value" style="color:var(--text-dim); font-size: 0.8rem;">{{credentialSubject.countryOfProduction}}</div>
        <div style="margin-top:10px;">
            <span class="label">Production Date</span>
            <div class="value" style="font-size: 0.85rem;">{{#if credentialSubject.productionDate}}{{credentialSubject.productionDate}}{{else}}N/A{{/if}}</div>
        </div>
    </div>

    <div class="cell span-12" style="background: rgba(0,0,0,0.2);">
        <span class="label">Material Composition Matrix</span>
        <table style="width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.8rem;">
            <thead>
                <tr style="text-align: left; color: var(--text-dim);">
                    <th style="padding: 8px 0;">Component</th>
                    <th>Mass Amount</th>
                    <th>Recycled %</th>
                    <th>Safety</th>
                    <th>Origin</th>
                </tr>
            </thead>
            <tbody>
                {{#each credentialSubject.materialsProvenance}}
                <tr style="border-top: 1px solid var(--slate-700);">
                    <td style="padding: 10px 0; font-weight: 700;">{{name}}</td>
                    <td>{{multiply massFraction 100}}% <small style="color:var(--text-dim)">({{massAmount.value}}{{massAmount.unit}})</small></td>
                    <td>{{multiply recycledAmount 100}}%</td>
                    <td>
                        {{#if (lookup . 'hazardous')}}
                            {{#if hazardous}}<span class="status-badge fail">HAZARD</span>
                            {{else}}<span class="status-badge pass">SAFE</span>{{/if}}
                        {{else}}<span class="status-badge">UNKNOWN</span>{{/if}}
                    </td>
                    <td>{{originCountry}}</td>
                </tr>
                {{/each}}
            </tbody>
        </table>
    </div>

    <div class="cell span-3">
        <span class="label">Carbon Impact</span>
        <div class="value-lg" style="color:var(--accent)">{{credentialSubject.emissionsScorecard.carbonFootprint}}</div>
        <span class="label" style="font-size: 0.5rem;">kg CO2e / unit</span>
    </div>

    <div class="cell span-3">
        <span class="label">Circularity Index</span>
        <div class="value-lg">{{multiply credentialSubject.circularityScorecard.materialCircularityIndicator 100}}%</div>
        <div style="height: 4px; background: var(--slate-700); margin-top: 8px;">
            <div style="height: 100%; background: var(--accent); width: {{multiply credentialSubject.circularityScorecard.materialCircularityIndicator 100}}%"></div>
        </div>
    </div>

    <div class="cell span-6">
        <span class="label">Product Lifecycle Support</span>
        <div style="display: flex; gap: 10px; margin-top: 5px;">
            <a href="https://example.com/Repair_information.pdf" style="color:white; font-size: 0.75rem; text-decoration: underline;">Repair_Documentation.pdf</a>
            <a href="https://example.com/Recycling_information.pdf" style="color:white; font-size: 0.75rem; text-decoration: underline;">Recycling_End_of_Life.pdf</a>
        </div>
    </div>

    <div class="cell span-8">
        <span class="label">Compliance & Conformity Registry</span>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
            {{#each credentialSubject.conformityClaim}}
            <div style="border-left: 2px solid var(--accent); padding-left: 10px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-size: 0.75rem; font-weight: 700;">{{referenceStandard.name}}</span>
                    {{#if conformance}}<span class="status-badge pass">PASS</span>{{else}}<span class="status-badge fail">FAIL</span>{{/if}}
                </div>
                {{#each declaredValue}}
                <div style="font-size: 0.65rem; color: var(--text-dim);">Declared: {{metricName}} ({{metricValue.value}} {{metricValue.unit}})</div>
                {{/each}}
                {{#each assessmentCriteria}}{{#each thresholdValue}}
                <div style="font-size: 0.65rem; color: #fbbf24;">Limit: {{metricValue.value}} {{
