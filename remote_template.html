<style>
    :root {
        --bg-main: #1e293b; /* Slightly lighter slate */
        --bg-card: #334155;
        --bg-inset: #0f172a;
        --neon-cyan: #06b6d4;
        --neon-amber: #f59e0b;
        --neon-green: #10b981;
        --text-bright: #f1f5f9;
        --text-dim: #94a3b8;
        --border: #475569;
        --radius: 12px;
    }

    .dpp-narrow-card {
        font-family: 'Inter', -apple-system, sans-serif;
        max-width: 580px; /* 2/3 of previous width */
        margin: 20px auto;
        background: var(--bg-main);
        color: var(--text-bright);
        border-radius: var(--radius);
        border: 1px solid var(--border);
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        overflow: hidden;
    }

    /* Identity Header */
    .dpp-head {
        padding: 24px;
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        border-bottom: 3px solid var(--neon-cyan);
    }

    .product-title { font-size: 1.5rem; font-weight: 800; margin: 0; letter-spacing: -0.5px; }
    .mfg-name { color: var(--neon-cyan); font-weight: 600; font-size: 0.85rem; text-transform: uppercase; }
    
    .id-ribbon {
        margin-top: 15px;
        font-family: 'JetBrains Mono', monospace;
        font-size: 0.7rem;
        padding: 6px 10px;
        background: rgba(0,0,0,0.3);
        border-radius: 4px;
        color: var(--text-dim);
        display: block;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    /* Visual Media Section */
    .dpp-media-strip {
        display: grid;
        grid-template-columns: 180px 1fr;
        gap: 20px;
        padding: 20px;
        background: var(--bg-inset);
    }
    .thumb { width: 100%; border-radius: 8px; border: 1px solid var(--border); }

    /* Compact Grid */
    .spec-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
    }
    .spec-item { padding-bottom: 8px; border-bottom: 1px solid var(--border); }
    .spec-label { font-size: 0.65rem; color: var(--text-dim); text-transform: uppercase; display: block; }
    .spec-value { font-size: 0.85rem; font-weight: 600; }

    /* Tables */
    .panel { padding: 20px; }
    .section-label { 
        color: var(--neon-cyan); 
        font-size: 0.75rem; 
        font-weight: 900; 
        margin-bottom: 12px; 
        display: flex; 
        align-items: center; 
        gap: 8px; 
    }
    .section-label::after { content: ''; flex: 1; height: 1px; background: var(--border); }

    .mini-table { width: 100%; border-collapse: collapse; font-size: 0.8rem; }
    .mini-table th { text-align: left; padding: 8px; color: var(--text-dim); border-bottom: 1px solid var(--border); }
    .mini-table td { padding: 10px 8px; border-bottom: 1px solid #47556955; }

    /* Neon Accents */
    .neon-pill {
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 0.65rem;
        font-weight: 800;
        text-transform: uppercase;
    }
    .neon-pill.cyan { background: rgba(6, 182, 212, 0.1); color: var(--neon-cyan); border: 1px solid var(--neon-cyan); }
    .neon-pill.green { background: rgba(16, 185, 129, 0.1); color: var(--neon-green); border: 1px solid var(--neon-green); }
    .neon-pill.amber { background: rgba(245, 158, 11, 0.1); color: var(--neon-amber); border: 1px solid var(--neon-amber); }

    /* Footer Stats */
    .footer-dashboard {
        display: flex;
        justify-content: space-between;
        background: var(--bg-inset);
        padding: 15px 20px;
        border-top: 1px solid var(--border);
    }
    .stat-val { display: block; font-size: 1.1rem; font-weight: 800; color: var(--neon-amber); }

    .btn-resource {
        text-decoration: none;
        color: var(--neon-cyan);
        font-size: 0.75rem;
        font-weight: 700;
        border: 1px solid var(--neon-cyan);
        padding: 5px 10px;
        border-radius: 4px;
        transition: all 0.2s;
    }
    .btn-resource:hover { background: var(--neon-cyan); color: var(--bg-inset); }

</style>

<div class="dpp-narrow-card">
    <header class="dpp-head">
        <span class="mfg-name">{{credentialSubject.producedByParty.name}}</span>
        <h1 class="product-title">{{credentialSubject.name}}</h1>
        <code class="id-ribbon" title="{{credentialSubject.id}}">ID: {{credentialSubject.id}}</code>
    </header>

    <div class="dpp-media-strip">
        <img src="{{#if credentialSubject.productImage.linkURL}}{{credentialSubject.productImage.linkURL}}{{else}}https://placehold.co/180x180/334155/f1f5f9?text=Product{{/if}}" 
             class="thumb" onerror="this.src='https://placehold.co/180x180/334155/f1f5f9?text=Product';">
        
        <div class="spec-grid">
            <div class="spec-item">
                <span class="spec-label">Location</span>
                <span class="spec-value">{{credentialSubject.countryOfProduction}}</span>
            </div>
            <div class="spec-item">
                <span class="spec-label">Facility</span>
                <span class="spec-value">{{credentialSubject.producedAtFacility.name}}</span>
            </div>
            {{#if credentialSubject.productionDate}}
            <div class="spec-item">
                <span class="spec-label">Date</span>
                <span class="spec-value">{{credentialSubject.productionDate}}</span>
            </div>
            {{/if}}
            {{#if credentialSubject.batchNumber}}
            <div class="spec-item">
                <span class="spec-label">Batch</span>
                <span class="spec-value">{{credentialSubject.batchNumber}}</span>
            </div>
            {{/if}}
        </div>
    </div>

    <div class="panel">
        <span class="section-label">Composition Matrix</span>
        <table class="mini-table">
            <thead>
                <tr>
                    <th>Material</th>
                    <th>Mass</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {{#each credentialSubject.materialsProvenance}}
                <tr>
                    <td><strong>{{name}}</strong><br><small style="color:var(--text-dim)">Source: {{originCountry}}</small></td>
                    <td>{{multiply massFraction 100}}%</td>
                    <td>
                        {{#if (lookup . 'hazardous')}}
                            {{#if hazardous}}<span class="neon-pill amber">Hazard</span>
                            {{else}}<span class="neon-pill green">Safe</span>{{/if}}
                        {{else}}<span class="neon-pill cyan">N/A</span>{{/if}}
                    </td>
                </tr>
                {{/each}}
            </tbody>
        </table>
    </div>
