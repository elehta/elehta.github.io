<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>UNTP Digital Product Passport</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.8/handlebars.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Mono:wght@400;500&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,300&display=swap" rel="stylesheet"/>
  <style>
    :root {
      --un-blue: #009EDB;
      --un-dark: #0A1628;
      --un-mid: #1A2E4A;
      --un-accent: #00C4B3;
      --un-warn: #F7B731;
      --un-green: #26C281;
      --un-red: #FC5C65;
      --bg: #F4F6FA;
      --surface: #FFFFFF;
      --surface2: #EEF2F9;
      --border: #D5DDED;
      --text: #1A2E4A;
      --text-muted: #6B7B99;
      --text-light: #9EB3CB;
      --radius: 10px;
      --shadow: 0 2px 16px rgba(10,22,40,0.08);
      --shadow-sm: 0 1px 4px rgba(10,22,40,0.06);
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'DM Sans', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 0 0 60px;
    }

    .passport-header {
      background: var(--un-dark);
      color: white;
      padding: 0;
      position: relative;
      overflow: hidden;
    }
    .passport-header::before {
      content: '';
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        90deg,
        transparent,
        transparent 40px,
        rgba(0,158,219,0.04) 40px,
        rgba(0,158,219,0.04) 41px
      );
    }
    .header-inner {
      max-width: 1000px;
      margin: 0 auto;
      padding: 40px 40px 32px;
      position: relative;
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 24px;
      align-items: start;
    }
    .header-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(0,158,219,0.15);
      border: 1px solid rgba(0,158,219,0.35);
      color: var(--un-blue);
      font-family: 'DM Mono', monospace;
      font-size: 10px;
      font-weight: 500;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      padding: 5px 12px;
      border-radius: 20px;
      margin-bottom: 14px;
    }
    .header-badge span { width: 6px; height: 6px; background: var(--un-blue); border-radius: 50%; }
    h1.passport-title {
      font-family: 'DM Serif Display', serif;
      font-size: 2.6rem;
      font-weight: 400;
      line-height: 1.15;
      color: white;
      margin-bottom: 10px;
    }
    h1.passport-title em { color: var(--un-blue); font-style: italic; }
    .passport-subtitle {
      font-size: 0.875rem;
      color: rgba(255,255,255,0.5);
      font-weight: 300;
      margin-bottom: 24px;
    }
    .header-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .meta-pill {
      display: flex;
      align-items: center;
      gap: 6px;
      background: rgba(255,255,255,0.07);
      border: 1px solid rgba(255,255,255,0.1);
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 0.78rem;
      color: rgba(255,255,255,0.7);
    }
    .meta-pill .dot { width: 5px; height: 5px; border-radius: 50%; flex-shrink: 0; }
    .meta-pill .label { color: rgba(255,255,255,0.4); margin-right: 2px; }
    .header-right {
      text-align: right;
      padding-top: 8px;
    }
    .granularity-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--un-blue), var(--un-accent));
      color: white;
      font-family: 'DM Mono', monospace;
      font-size: 0.72rem;
      font-weight: 500;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      padding: 6px 16px;
      border-radius: 20px;
      margin-bottom: 10px;
    }
    .product-image-wrap {
      width: 100px;
      height: 100px;
      border-radius: 12px;
      border: 2px solid rgba(255,255,255,0.12);
      overflow: hidden;
      background: rgba(255,255,255,0.06);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: auto;
    }
    .product-image-wrap img { width: 100%; height: 100%; object-fit: cover; }
    .product-image-placeholder {
      color: rgba(255,255,255,0.2);
      font-size: 2.5rem;
    }

    .passport-body {
      max-width: 1000px;
      margin: 0 auto;
      padding: 32px 40px;
      display: grid;
      gap: 24px;
    }

    .section-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-sm);
      overflow: hidden;
      animation: fadeUp 0.4s ease both;
    }
    .section-card:nth-child(1) { animation-delay: 0.05s; }
    .section-card:nth-child(2) { animation-delay: 0.1s; }
    .section-card:nth-child(3) { animation-delay: 0.15s; }
    .section-card:nth-child(4) { animation-delay: 0.2s; }
    .section-card:nth-child(5) { animation-delay: 0.25s; }
    .section-card:nth-child(6) { animation-delay: 0.3s; }
    .section-card:nth-child(7) { animation-delay: 0.35s; }
    .section-card:nth-child(8) { animation-delay: 0.4s; }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .section-head {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 22px;
      border-bottom: 1px solid var(--border);
      background: var(--surface2);
    }
    .section-icon {
      width: 34px;
      height: 34px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      flex-shrink: 0;
    }
    .section-head h2 {
      font-family: 'DM Sans', sans-serif;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-muted);
    }
    .section-body { padding: 20px 22px; }

    .field-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 16px;
    }
    .field-grid.full { grid-template-columns: 1fr; }
    .field-grid.halves { grid-template-columns: 1fr 1fr; }
    .field-grid.thirds { grid-template-columns: 1fr 1fr 1fr; }

    .field { display: flex; flex-direction: column; gap: 4px; }
    .field-label {
      font-family: 'DM Mono', monospace;
      font-size: 0.68rem;
      font-weight: 500;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--text-light);
    }
    .field-value { font-size: 0.88rem; font-weight: 400; color: var(--text); line-height: 1.4; word-break: break-word; }
    .field-value.mono { font-family: 'DM Mono', monospace; font-size: 0.78rem; color: var(--un-mid); }
    .field-value.link a { color: var(--un-blue); text-decoration: none; border-bottom: 1px dashed rgba(0,158,219,0.4); }
    .field-value.link a:hover { border-bottom-style: solid; }
    .field-value.empty { color: var(--text-light); font-style: italic; font-size: 0.8rem; }
    .field-value.number { font-family: 'DM Mono', monospace; font-size: 1.1rem; font-weight: 500; color: var(--un-mid); }
    .field-value.country-code { display: inline-flex; align-items: center; gap: 6px; font-family: 'DM Mono', monospace; font-weight: 500; }

    .status-badge {
      display: inline-block;
      font-family: 'DM Mono', monospace;
      font-size: 0.7rem;
      font-weight: 500;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      padding: 3px 10px;
      border-radius: 20px;
    }
    .status-true { background: rgba(38,194,129,0.12); color: var(--un-green); }
    .status-false { background: rgba(252,92,101,0.12); color: var(--un-red); }
    .status-neutral { background: rgba(107,123,153,0.12); color: var(--text-muted); }

    .divider { height: 1px; background: var(--border); margin: 16px 0; }

    .dimensions-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; }
    .dim-block {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      text-align: center;
    }
    .dim-block .dim-icon { font-size: 1.4rem; margin-bottom: 4px; }
    .dim-block .dim-value { font-family: 'DM Mono', monospace; font-size: 1rem; font-weight: 500; color: var(--text); }
    .dim-block .dim-unit { font-size: 0.7rem; color: var(--text-muted); }
    .dim-block .dim-label { font-size: 0.68rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-light); margin-top: 2px; }

    .scorecard-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .score-item {
      background: var(--surface2);
      border-radius: 8px;
      padding: 14px 16px;
      border: 1px solid var(--border);
    }
    .score-label { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.06em; color: var(--text-muted); margin-bottom: 6px; }
    .score-value { font-family: 'DM Serif Display', serif; font-size: 1.8rem; color: var(--text); margin-bottom: 4px; }
    .score-unit { font-family: 'DM Mono', monospace; font-size: 0.75rem; color: var(--text-muted); }
    .progress-bar { height: 6px; background: var(--border); border-radius: 3px; margin-top: 8px; overflow: hidden; }
    .progress-fill { height: 100%; border-radius: 3px; transition: width 1s ease; }
    .fill-green { background: linear-gradient(90deg, var(--un-green), var(--un-accent)); }
    .fill-blue { background: linear-gradient(90deg, var(--un-blue), var(--un-accent)); }

    .material-item {
      display: grid;
      grid-template-columns: auto 1fr auto auto;
      gap: 12px;
      align-items: center;
      padding: 12px 16px;
      border-radius: 8px;
      background: var(--surface2);
      border: 1px solid var(--border);
      margin-bottom: 10px;
    }
    .material-item:last-child { margin-bottom: 0; }
    .material-index {
      width: 28px; height: 28px;
      background: var(--un-dark); color: white;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-family: 'DM Mono', monospace; font-size: 0.72rem; font-weight: 500;
      flex-shrink: 0;
    }
    .material-main .mat-name { font-weight: 500; font-size: 0.88rem; }
    .material-main .mat-origin { font-size: 0.75rem; color: var(--text-muted); font-family: 'DM Mono', monospace; }
    .material-fraction { text-align: right; }
    .material-fraction .frac-val { font-family: 'DM Serif Display', serif; font-size: 1.3rem; color: var(--text); }
    .material-fraction .frac-label { font-size: 0.68rem; color: var(--text-muted); text-transform: uppercase; }
    .hazard-tag { font-size: 0.68rem; font-family: 'DM Mono', monospace; padding: 2px 8px; border-radius: 4px; }
    .hazard-yes { background: rgba(252,92,101,0.12); color: var(--un-red); }
    .hazard-no { background: rgba(38,194,129,0.1); color: var(--un-green); }

    .claim-item { border: 1px solid var(--border); border-radius: 8px; overflow: hidden; margin-bottom: 10px; }
    .claim-item:last-child { margin-bottom: 0; }
    .claim-header {
      display: flex; align-items: center; gap: 12px;
      padding: 14px 16px; cursor: pointer;
      background: var(--surface2); transition: background 0.2s; user-select: none;
    }
    .claim-header:hover { background: #E4EBF7; }
    .claim-header.active { background: #E4EBF7; }
    .topic-badge {
      font-family: 'DM Mono', monospace; font-size: 0.65rem; font-weight: 500;
      padding: 3px 10px; border-radius: 20px;
      text-transform: uppercase; letter-spacing: 0.05em; white-space: nowrap;
    }
    .topic-emissions { background: rgba(247,183,49,0.15); color: #C08A00; }
    .topic-circularity { background: rgba(38,194,129,0.15); color: var(--un-green); }
    .topic-environment { background: rgba(0,158,219,0.15); color: var(--un-blue); }
    .topic-social { background: rgba(155,89,182,0.15); color: #9B59B6; }
    .topic-default { background: rgba(107,123,153,0.12); color: var(--text-muted); }
    .claim-title { font-size: 0.85rem; font-weight: 500; flex: 1; }
    .claim-conformance { margin-left: auto; flex-shrink: 0; }
    .claim-chevron { width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; color: var(--text-light); transition: transform 0.25s; flex-shrink: 0; }
    .claim-chevron.open { transform: rotate(180deg); }
    .claim-body { display: none; padding: 16px; border-top: 1px solid var(--border); }
    .claim-body.open { display: block; }
    .metrics-row { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
    .metric-chip { background: var(--un-dark); color: white; border-radius: 6px; padding: 8px 14px; font-family: 'DM Mono', monospace; font-size: 0.78rem; }
    .metric-chip .mc-name { font-size: 0.65rem; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 0.05em; }
    .metric-chip .mc-value { font-size: 1rem; font-weight: 500; margin-top: 2px; }

    .trace-item { display: flex; gap: 14px; padding: 12px 0; border-bottom: 1px solid var(--border); }
    .trace-item:last-child { border-bottom: none; }
    .trace-line { display: flex; flex-direction: column; align-items: center; flex-shrink: 0; }
    .trace-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--un-blue); border: 2px solid white; box-shadow: 0 0 0 2px var(--un-blue); flex-shrink: 0; margin-top: 4px; }
    .trace-connector { width: 2px; flex: 1; background: var(--border); margin: 4px 0; min-height: 20px; }
    .trace-content { flex: 1; }
    .trace-process { font-weight: 500; font-size: 0.88rem; margin-bottom: 4px; }
    .trace-ratio { font-size: 0.78rem; color: var(--text-muted); font-family: 'DM Mono', monospace; }
    .trace-links { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px; }
    .trace-link-chip { font-size: 0.72rem; padding: 3px 10px; border-radius: 4px; background: var(--surface2); border: 1px solid var(--border); color: var(--un-blue); text-decoration: none; }
    .trace-link-chip:hover { background: var(--border); }

    .issuer-grid { display: grid; grid-template-columns: auto 1fr; gap: 16px; align-items: start; }
    .issuer-avatar { width: 48px; height: 48px; background: var(--un-dark); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-family: 'DM Serif Display', serif; font-size: 1.3rem; color: var(--un-blue); flex-shrink: 0; }
    .issuer-name { font-weight: 600; font-size: 0.95rem; margin-bottom: 2px; }
    .issuer-did { font-family: 'DM Mono', monospace; font-size: 0.72rem; color: var(--text-muted); word-break: break-all; }
    .known-as-list { display: flex; flex-direction: column; gap: 8px; margin-top: 12px; }
    .known-as-item { display: flex; align-items: center; gap: 10px; padding: 8px 12px; background: var(--surface2); border-radius: 6px; border: 1px solid var(--border); }
    .known-as-scheme { font-size: 0.72rem; color: var(--text-muted); font-family: 'DM Mono', monospace; }
    .known-as-id { font-family: 'DM Mono', monospace; font-size: 0.78rem; color: var(--text); font-weight: 500; }

    .validity-bar {
      display: grid; grid-template-columns: 1fr auto 1fr; gap: 12px; align-items: center;
      padding: 14px 18px;
      background: linear-gradient(135deg, rgba(0,158,219,0.06), rgba(0,196,179,0.06));
      border: 1px solid rgba(0,158,219,0.2); border-radius: 8px;
    }
    .validity-date .vd-label { font-size: 0.68rem; text-transform: uppercase; letter-spacing: 0.06em; color: var(--text-light); font-family: 'DM Mono', monospace; }
    .validity-date .vd-val { font-family: 'DM Mono', monospace; font-size: 0.85rem; font-weight: 500; color: var(--text); margin-top: 2px; }
    .validity-arrow { text-align: center; color: var(--un-blue); font-size: 1rem; }
    .validity-date.end .vd-label, .validity-date.end .vd-val { text-align: right; }

    .json-toggle {
      display: inline-flex; align-items: center; gap: 6px;
      background: none; border: 1px solid var(--border); border-radius: 6px;
      padding: 6px 14px; font-family: 'DM Mono', monospace; font-size: 0.75rem;
      color: var(--text-muted); cursor: pointer; transition: all 0.2s;
    }
    .json-toggle:hover { border-color: var(--un-blue); color: var(--un-blue); }
    .json-block { display: none; margin-top: 12px; background: #0F1A2E; border-radius: 8px; padding: 16px; overflow-x: auto; }
    .json-block.open { display: block; }
    .json-block pre { font-family: 'DM Mono', monospace; font-size: 0.75rem; color: #8ECBFF; line-height: 1.6; white-space: pre-wrap; }

    .icon-blue { background: rgba(0,158,219,0.1); }
    .icon-green { background: rgba(38,194,129,0.1); }
    .icon-yellow { background: rgba(247,183,49,0.1); }
    .icon-purple { background: rgba(155,89,182,0.1); }
    .icon-teal { background: rgba(0,196,179,0.1); }
    .icon-dark { background: rgba(26,46,74,0.08); }
    .icon-red { background: rgba(252,92,101,0.1); }

    @media (max-width: 700px) {
      .header-inner { grid-template-columns: 1fr; }
      .header-right { display: flex; align-items: center; gap: 12px; }
      .product-image-wrap { margin-left: 0; }
      .passport-body { padding: 20px 16px; }
      h1.passport-title { font-size: 1.8rem; }
      .dimensions-grid { grid-template-columns: repeat(3, 1fr); }
      .scorecard-grid { grid-template-columns: 1fr; }
      .field-grid.thirds { grid-template-columns: 1fr 1fr; }
    }
  </style>
</head>
<body>

<script id="dpp-template" type="text/x-handlebars-template">
  {{#if product.name}}
  <header class="passport-header">
    <div class="header-inner">
      <div>
        <div class="header-badge"><span></span>UN Transparency Protocol ¬∑ Digital Product Passport</div>
        <h1 class="passport-title">{{product.name}}</h1>
        <p class="passport-subtitle">Credential ID: {{credentialId}}</p>
        <div class="header-meta">
          {{#if product.registeredId}}<div class="meta-pill"><div class="dot" style="background:#009EDB"></div><span class="label">ID</span> {{product.registeredId}}</div>{{/if}}
          {{#if product.serialNumber}}<div class="meta-pill"><div class="dot" style="background:#00C4B3"></div><span class="label">S/N</span> {{product.serialNumber}}</div>{{/if}}
          {{#if product.batchNumber}}<div class="meta-pill"><div class="dot" style="background:#F7B731"></div><span class="label">Batch</span> {{product.batchNumber}}</div>{{/if}}
          {{#if product.countryOfProduction}}<div class="meta-pill"><div class="dot" style="background:#26C281"></div><span class="label">Origin</span> {{product.countryOfProduction}}</div>{{/if}}
          {{#if product.productionDate}}<div class="meta-pill"><div class="dot" style="background:#9B59B6"></div><span class="label">Produced</span> {{product.productionDate}}</div>{{/if}}
        </div>
      </div>
      <div class="header-right">
        {{#if granularityLevel}}<div class="granularity-badge">{{granularityLevel}}</div>{{/if}}
        <div class="product-image-wrap">
          {{#if product.productImage.linkURL}}
          <img src="{{product.productImage.linkURL}}" alt="{{product.name}}" onerror="this.style.display='none'"/>
          {{else}}
          <div class="product-image-placeholder">üì¶</div>
          {{/if}}
        </div>
      </div>
    </div>
  </header>
  {{/if}}

  <div class="passport-body">
    {{#if validFrom}}
    <div class="validity-bar">
      <div class="validity-date"><div class="vd-label">Valid From</div><div class="vd-val">{{formatDate validFrom}}</div></div>
      <div class="validity-arrow">‚Üí</div>
      <div class="validity-date end"><div class="vd-label">Valid Until</div><div class="vd-val">{{#if validUntil}}{{formatDate validUntil}}{{else}}‚Äì{{/if}}</div></div>
    </div>
    {{/if}}

    <div class="section-card">
      <div class="section-head"><div class="section-icon icon-blue">üè∑Ô∏è</div><h2>Product Identification</h2></div>
      <div class="section-body">
        <div class="field-grid">
          <div class="field"><div class="field-label">Product Name</div><div class="field-value">{{#if product.name}}{{product.name}}{{else}}<span class="empty">‚Äî</span>{{/if}}</div></div>
          <div class="field"><div class="field-label">Registered ID</div><div class="field-value mono">{{#if product.registeredId}}{{product.registeredId}}{{else}}<span class="empty">‚Äî</span>{{/if}}</div></div>
          <div class="field"><div class="field-label">Serial Number</div><div class="field-value mono">{{#if product.serialNumber}}{{product.serialNumber}}{{else}}<span class="empty">‚Äî</span>{{/if}}</div></div>
          <div class="field"><div class="field-label">Batch Number</div><div class="field-value mono">{{#if product.batchNumber}}{{product.batchNumber}}{{else}}<span class="empty">‚Äî</span>{{/if}}</div></div>
          <div class="field"><div class="field-label">Country of Production</div><div class="field-value country-code">{{#if product.countryOfProduction}}üåè {{product.countryOfProduction}}{{else}}<span class="empty">‚Äî</span>{{/if}}</div></div>
          <div class="field"><div class="field-label">Production Date</div><div class="field-value mono">{{#if product.productionDate}}{{product.productionDate}}{{else}}<span class="empty">‚Äî</span>{{/if}}</div></div>
        </div>
        {{#if product.description}}<div class="divider"></div><div class="field"><div class="field-label">Description</div><div class="field-value">{{product.description}}</div></div>{{/if}}
        {{#if product.idScheme.name}}
        <div class="divider"></div>
        <div class="field-grid halves">
          <div class="field"><div class="field-label">ID Scheme</div><div class="field-value">{{product.idScheme.name}}</div></div>
          <div class="field"><div class="field-label">Scheme URI</div><div class="field-value link"><a href="{{product.idScheme.id}}" target="_blank">{{product.idScheme.id}}</a></div></div>
        </div>
        {{/if}}
        {{#if product.productCategory.length}}
        <div class="divider"></div>
        <div class="field-label" style="margin-bottom:10px">Product Categories</div>
        {{#each product.productCategory}}
        <div style="display:flex;gap:10px;align-items:center;padding:8px 12px;background:var(--surface2);border:1px solid var(--border);border-radius:6px;margin-bottom:6px">
          <div style="font-family:'DM Mono',monospace;font-size:0.75rem;background:var(--un-dark);color:var(--un-blue);padding:3px 8px;border-radius:4px">{{code}}</div>
          <div style="flex:1;font-size:0.85rem">{{name}}</div>
          <div style="font-size:0.72rem;color:var(--text-muted)">{{schemeName}}</div>
        </div>
        {{/each}}
        {{/if}}
      </div>
    </div>

    {{#if product.dimensions}}
    <div class="section-card">
      <div class="section-head"><div class="section-icon icon-teal">üìê</div><h2>Physical Dimensions</h2></div>
      <div class="section-body">
        <div class="dimensions-grid">
          {{#if product.dimensions.weight}}<div class="dim-block"><div class="dim-icon">‚öñÔ∏è</div><div class="dim-value">{{product.dimensions.weight.value}}</div><div class="dim-unit">{{product.dimensions.weight.unit}}</div><div class="dim-label">Weight</div></div>{{/if}}
          {{#if product.dimensions.length}}<div class="dim-block"><div class="dim-icon">‚ÜîÔ∏è</div><div class="dim-value">{{product.dimensions.length.value}}</div><div class="dim-unit">{{product.dimensions.length.unit}}</div><div class="dim-label">Length</div></div>{{/if}}
          {{#if product.dimensions.width}}<div class="dim-block"><div class="dim-icon">‚ÜïÔ∏è</div><div class="dim-value">{{product.dimensions.width.value}}</div><div class="dim-unit">{{product.dimensions.width.unit}}</div><div class="dim-label">Width</div></div>{{/if}}
          {{#if product.dimensions.height}}<div class="dim-block"><div class="dim-icon">üìè</div><div class="dim-value">{{product.dimensions.height.value}}</div><div class="dim-unit">{{product.dimensions.height.unit}}</div><div class="dim-label">Height</div></div>{{/if}}
          {{#if product.dimensions.volume}}<div class="dim-block"><div class="dim-icon">üßä</div><div class="dim-value">{{product.dimensions.volume.value}}</div><div class="dim-unit">{{product.dimensions.volume.unit}}</div><div class="dim-label">Volume</div></div>{{/if}}
        </div>
      </div>
    </div>
    {{/if}}

    <div class="section-card">
      <div class="section-head"><div class="section-icon icon-dark">üè≠</div><h2>Manufacturer & Facility</h2></div>
      <div class="section-body">
        <div class="field-grid halves">
          <div>
            <div class="field-label" style="margin-bottom:8px">Produced By</div>
            {{#if product.producedByParty.name}}
            <div style="padding:12px;background:var(--surface2);border-radius:8px;border:1px solid var(--border)">
              <div style="font-weight:500;margin-bottom:4px">{{product.producedByParty.name}}</div>
              <div style="font-family:'DM Mono',monospace;font-size:0.72rem;color:var(--text-muted)">{{product.producedByParty.registeredId}}</div>
              {{#if product.producedByParty.idScheme.name}}<div style="font-size:0.72rem;color:var(--text-light);margin-top:2px">{{product.producedByParty.idScheme.name}}</div>{{/if}}
            </div>
            {{else}}<div class="field-value empty">Not specified</div>{{/if}}
          </div>
          <div>
            <div class="field-label" style="margin-bottom:8px">Produced At Facility</div>
            {{#if product.producedAtFacility.name}}
            <div style="padding:12px;background:var(--surface2);border-radius:8px;border:1px solid var(--border)">
              <div style="font-weight:500;margin-bottom:4px">{{product.producedAtFacility.name}}</div>
              <div style="font-family:'DM Mono',monospace;font-size:0.72rem;color:var(--text-muted)">{{product.producedAtFacility.registeredId}}</div>
              {{#if product.producedAtFacility.idScheme.name}}<div style="font-size:0.72rem;color:var(--text-light);margin-top:2px">{{product.producedAtFacility.idScheme.name}}</div>{{/if}}
            </div>
            {{else}}<div class="field-value empty">Not specified</div>{{/if}}
          </div>
        </div>
      </div>
    </div>

    {{#if emissionsScorecard}}
    <div class="section-card">
      <div class="section-head"><div class="section-icon icon-yellow">üå°Ô∏è</div><h2>Emissions Scorecard</h2></div>
      <div class="section-body">
        <div class="scorecard-grid">
          <div class="score-item"><div class="score-label">Carbon Footprint</div><div class="score-value">{{emissionsScorecard.carbonFootprint}}</div><div class="score-unit">CO‚ÇÇe / {{emissionsScorecard.declaredUnit}}</div></div>
          <div class="score-item"><div class="score-label">Primary Sourced Ratio</div><div class="score-value">{{multiplyByHundred emissionsScorecard.primarySourcedRatio}}%</div><div class="score-unit">Directly measured data</div><div class="progress-bar"><div class="progress-fill fill-green" style="width:{{multiplyByHundred emissionsScorecard.primarySourcedRatio}}%"></div></div></div>
        </div>
        <div class="divider"></div>
        <div class="field-grid thirds">
          <div class="field"><div class="field-label">Operational Scope</div><div class="field-value"><span class="status-badge status-neutral">{{emissionsScorecard.operationalScope}}</span></div></div>
          {{#if emissionsScorecard.reportingStandard.name}}<div class="field"><div class="field-label">Reporting Standard</div><div class="field-value link"><a href="{{emissionsScorecard.reportingStandard.id}}" target="_blank">{{emissionsScorecard.reportingStandard.name}}</a></div></div>{{/if}}
          {{#if emissionsScorecard.reportingStandard.issuingParty.name}}<div class="field"><div class="field-label">Issuing Party</div><div class="field-value">{{emissionsScorecard.reportingStandard.issuingParty.name}}</div></div>{{/if}}
        </div>
      </div>
    </div>
    {{/if}}

    {{#if circularityScorecard}}
    <div class="section-card">
      <div class="section-head"><div class="section-icon icon-green">‚ôªÔ∏è</div><h2>Circularity Scorecard</h2></div>
      <div class="section-body">
        <div class="scorecard-grid">
          {{#if circularityScorecard.recycledContent}}<div class="score-item"><div class="score-label">Recycled Content</div><div class="score-value">{{multiplyByHundred circularityScorecard.recycledContent}}%</div><div class="score-unit">by mass fraction</div><div class="progress-bar"><div class="progress-fill fill-green" style="width:{{multiplyByHundred circularityScorecard.recycledContent}}%"></div></div></div>{{/if}}
          {{#if circularityScorecard.recyclableContent}}<div class="score-item"><div class="score-label">Recyclable Content</div><div class="score-value">{{multiplyByHundred circularityScorecard.recyclableContent}}%</div><div class="score-unit">by mass fraction</div><div class="progress-bar"><div class="progress-fill fill-blue" style="width:{{multiplyByHundred circularityScorecard.recyclableContent}}%"></div></div></div>{{/if}}
        </div>
        {{#if circularityScorecard.repairability}}<div class="divider"></div><div class="field-grid thirds"><div class="field"><div class="field-label">Repairability Score</div><div class="field-value number">{{circularityScorecard.repairability}}</div></div></div>{{/if}}
        {{#if circularityScorecard.recyclingInformation.linkURL}}<div class="divider"></div><div class="field"><div class="field-label">Recycling Information</div><div class="field-value link"><a href="{{circularityScorecard.recyclingInformation.linkURL}}" target="_blank">{{circularityScorecard.recyclingInformation.linkName}}</a></div></div>{{/if}}
      </div>
    </div>
    {{/if}}

    {{#if materialsProvenance.length}}
    <div class="section-card">
      <div class="section-head"><div class="section-icon icon-teal">üß±</div><h2>Materials Provenance</h2></div>
      <div class="section-body">
        {{#each materialsProvenance}}
        <div class="material-item">
          <div class="material-index">{{addOne @index}}</div>
          <div class="material-main"><div class="mat-name">{{name}}</div><div class="mat-origin">{{originCountry}}{{#if materialType.name}} ¬∑ {{materialType.name}}{{/if}}</div></div>
          <div class="material-fraction"><div class="frac-val">{{multiplyByHundred massFraction}}%</div><div class="frac-label">mass</div>{{#if recycledMassFraction}}<div style="font-size:0.68rem;color:var(--un-green);margin-top:2px">{{multiplyByHundred recycledMassFraction}}% recycled</div>{{/if}}</div>
          <div>{{#if hazardous}}<span class="hazard-tag hazard-yes">‚ö† Hazardous</span>{{else}}<span class="hazard-tag hazard-no">‚úì Safe</span>{{/if}}</div>
        </div>
        {{/each}}
      </div>
    </div>
    {{/if}}

    {{#if conformityClaim.length}}
    <div class="section-card">
      <div class="section-head"><div class="section-icon icon-purple">üìã</div><h2>Conformity Claims</h2></div>
      <div class="section-body">
        {{#each conformityClaim}}
        <div class="claim-item">
          <div class="claim-header" onclick="toggleClaim(this)">
            <span class="topic-badge {{topicClass conformityTopic}}">{{conformityTopic}}</span>
            <span class="claim-title">{{#if description}}{{truncate description 80}}{{else}}Claim {{addOne @index}}{{/if}}</span>
            <span class="claim-conformance">{{#if conformance}}<span class="status-badge status-true">‚úì Conformant</span>{{else}}<span class="status-badge status-false">‚úó Non-conformant</span>{{/if}}</span>
            <div class="claim-chevron">‚ñæ</div>
          </div>
          <div class="claim-body">
            <div class="field-grid halves" style="margin-bottom:14px">
              {{#if referenceStandard.name}}<div class="field"><div class="field-label">Reference Standard</div><div class="field-value link"><a href="{{referenceStandard.id}}" target="_blank">{{referenceStandard.name}}</a></div></div>{{/if}}
              {{#if referenceRegulation.name}}<div class="field"><div class="field-label">Reference Regulation</div><div class="field-value link"><a href="{{referenceRegulation.id}}" target="_blank">{{referenceRegulation.name}}</a></div></div>{{/if}}
              {{#if assessmentDate}}<div class="field"><div class="field-label">Assessment Date</div><div class="field-value mono">{{assessmentDate}}</div></div>{{/if}}
              {{#if conformityEvidence.linkURL}}<div class="field"><div class="field-label">Evidence</div><div class="field-value link"><a href="{{conformityEvidence.linkURL}}" target="_blank">{{conformityEvidence.linkName}}</a></div></div>{{/if}}
            </div>
            {{#if declaredValue.length}}
            <div class="field-label" style="margin-bottom:8px">Declared Metrics</div>
            <div class="metrics-row">
              {{#each declaredValue}}
              <div class="metric-chip"><div class="mc-name">{{metricName}}</div><div class="mc-value">{{metricValue.value}} <span style="font-size:0.7rem;opacity:0.6">{{metricValue.unit}}</span></div>{{#if score}}<div style="font-size:0.68rem;margin-top:2px;opacity:0.7">Score: {{score}}</div>{{/if}}</div>
              {{/each}}
            </div>
            {{/if}}
          </div>
        </div>
        {{/each}}
      </div>
    </div>
    {{/if}}

    {{#if traceabilityInformation.length}}
    <div class="section-card">
      <div class="section-head"><div class="section-icon icon-blue">üîó</div><h2>Traceability Information</h2></div>
      <div class="section-body">
        {{#each traceabilityInformation}}
        <div class="trace-item">
          <div class="trace-line"><div class="trace-dot"></div>{{#unless @last}}<div class="trace-connector"></div>{{/unless}}</div>
          <div class="trace-content">
            <div class="trace-process">{{valueChainProcess}}</div>
            {{#if verifiedRatio}}<div class="trace-ratio">Verified ratio: {{multiplyByHundred verifiedRatio}}%</div>{{/if}}
            {{#if traceabilityEvent.length}}<div class="trace-links">{{#each traceabilityEvent}}<a href="{{linkURL}}" target="_blank" class="trace-link-chip">üîó {{linkName}}</a>{{/each}}</div>{{/if}}
          </div>
        </div>
        {{/each}}
      </div>
    </div>
    {{/if}}

    {{#if dueDiligenceDeclaration.linkURL}}
    <div class="section-card">
      <div class="section-head"><div class="section-icon icon-red">‚öñÔ∏è</div><h2>Due Diligence Declaration</h2></div>
      <div class="section-body">
        <div class="field-grid halves">
          <div class="field"><div class="field-label">Document Name</div><div class="field-value">{{dueDiligenceDeclaration.linkName}}</div></div>
          <div class="field"><div class="field-label">Document Link</div><div class="field-value link"><a href="{{dueDiligenceDeclaration.linkURL}}" target="_blank">{{dueDiligenceDeclaration.linkURL}}</a></div></div>
        </div>
      </div>
    </div>
    {{/if}}

    {{#if product.furtherInformation.length}}
    <div class="section-card">
      <div class="section-head"><div class="section-icon icon-dark">üìé</div><h2>Further Information</h2></div>
      <div class="section-body">
        {{#each product.furtherInformation}}
        <div style="display:flex;align-items:center;gap:12px;padding:10px 14px;background:var(--surface2);border:1px solid var(--border);border-radius:6px;margin-bottom:8px">
          <div style="flex:1"><div style="font-weight:500;font-size:0.85rem;margin-bottom:2px">{{linkName}}</div><div style="font-family:'DM Mono',monospace;font-size:0.72rem;color:var(--text-muted)">{{linkType}}</div></div>
          <a href="{{linkURL}}" target="_blank" style="font-size:0.78rem;color:var(--un-blue);text-decoration:none;border:1px solid rgba(0,158,219,0.3);padding:4px 12px;border-radius:4px">View ‚Üí</a>
        </div>
        {{/each}}
      </div>
    </div>
    {{/if}}

    {{#if issuer.name}}
    <div class="section-card">
      <div class="section-head"><div class="section-icon icon-dark">üèõÔ∏è</div><h2>Credential Issuer</h2></div>
      <div class="section-body">
        <div class="issuer-grid">
          <div class="issuer-avatar">{{firstLetter issuer.name}}</div>
          <div><div class="issuer-name">{{issuer.name}}</div><div class="issuer-did">{{issuer.id}}</div></div>
        </div>
        {{#if issuer.issuerAlsoKnownAs.length}}
        <div class="divider"></div>
        <div class="field-label" style="margin-bottom:8px">Also Known As</div>
        <div class="known-as-list">
          {{#each issuer.issuerAlsoKnownAs}}
          <div class="known-as-item"><div style="flex:1"><div class="known-as-id">{{registeredId}}</div><div class="known-as-scheme">{{idScheme.name}}</div></div><a href="{{id}}" target="_blank" style="font-size:0.72rem;color:var(--un-blue);text-decoration:none">‚Üó</a></div>
          {{/each}}
        </div>
        {{/if}}
      </div>
    </div>
    {{/if}}

    <div style="display:flex;justify-content:flex-end">
      <button class="json-toggle" onclick="toggleJson()"><span>{ }</span> View Raw JSON</button>
    </div>
    <div class="json-block" id="raw-json"><pre id="json-content"></pre></div>

  </div>
</script>

<div id="passport-root"></div>

<script>
  Handlebars.registerHelper('formatDate', function(d) {
    if (!d) return '‚Äî';
    try { return new Date(d).toLocaleDateString('en-US', { year:'numeric', month:'long', day:'numeric' }); }
    catch(e) { return d; }
  });
  Handlebars.registerHelper('multiplyByHundred', function(v) { return v == null ? '‚Äî' : Math.round(v * 100); });
  Handlebars.registerHelper('addOne', function(i) { return i + 1; });
  Handlebars.registerHelper('truncate', function(s, l) { return s && s.length > l ? s.slice(0,l)+'‚Ä¶' : s||''; });
  Handlebars.registerHelper('topicClass', function(t) {
    if (!t) return 'topic-default';
    const s = t.toLowerCase();
    if (s.includes('emission')) return 'topic-emissions';
    if (s.includes('circular')||s.includes('content')||s.includes('waste')) return 'topic-circularity';
    if (s.includes('environment')||s.includes('energy')) return 'topic-environment';
    if (s.includes('social')) return 'topic-social';
    return 'topic-default';
  });
  Handlebars.registerHelper('firstLetter', function(s) { return s ? s.charAt(0).toUpperCase() : '?'; });

  const template = Handlebars.compile(document.getElementById('dpp-template').innerHTML);
  document.getElementById('passport-root').innerHTML = template(dppData);
  window._dppData = dppData;

  function toggleClaim(el) {
    const body = el.nextElementSibling;
    const chevron = el.querySelector('.claim-chevron');
    const open = body.classList.toggle('open');
    chevron.classList.toggle('open', open);
    el.classList.toggle('active', open);
  }
  function toggleJson() {
    const block = document.getElementById('raw-json');
    if (!block.classList.contains('open')) document.getElementById('json-content').textContent = JSON.stringify(window._dppData, null, 2);
    block.classList.toggle('open');
  }
</script>
</body>
</html>
