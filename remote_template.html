<!DOCTYPE html>
<html>
  <head>
    <style>
      :root { --font-main: 'Inter', -apple-system, sans-serif; --font-mono: 'JetBrains Mono', 'Fira Code', monospace; --radius: 12px; --shadow: 0 4px 20px rgba(0, 0, 0, 0.08); --dpp-primary: #10b981; --dcc-primary: #3b82f6; --dia-primary: #64748b; }
      .verified-badge, .safe-badge, .score-high { background: var(--dpp-primary); }
      .revoked-badge, .hazardous-badge, .score-low { background: #ef4444; }
      .unknown-badge, .score-mid { background: #f59e0b; }
      body { margin: 0; padding: 0; min-height: 100vh; display: flex; justify-content: center; align-items: center; background-color: #f3f4f6; }
      .card-viewer { display: flex; flex-direction: row; gap: 24px; flex-wrap: wrap; justify-content: center; padding: 20px; box-sizing: border-box; width: 100%; max-width: 900px; }
      .credential-card { font-family: var(--font-main); width: clamp(280px, 95%, 640px); background: #ffffff; border-radius: var(--radius); border: 1px solid #e5e7eb; box-shadow: var(--shadow); overflow: hidden; position: relative; transition: transform 0.2s ease; flex-shrink: 1; flex-grow: 0; margin: 10px auto; box-sizing: border-box; }
      .credential-header { padding: 16px 20px; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid #f3f4f6; }
      .item-dpp .credential-header::before { content: '♻️'; font-size: 2.25rem; }
      .credential-body { padding: 20px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; min-width: 0; }
      .data-row { display: flex; align-items: flex-start; margin-bottom: 18px; font-size: 1.12rem; width: 100%; align-items: baseline; }
      .label { flex: 0 0 30%; color: #6b7280; font-size: 0.95rem; text-transform: uppercase; letter-spacing: 0.05em; text-align: left; line-height: 1.5; }
      .value { flex: 0 0 70%; font-weight: 600; color: #111827; text-align: right; padding-right: 15px; line-height: 1.5; white-space: normal; overflow-wrap: break-word; }
      .item-dpp { border-top: 4px solid var(--dpp-primary); }
      .item-dpp .credential-header { background: linear-gradient(to top, #ffffff, #dfebe1); }
      .badge { color: #ffffff; font-weight: 900; padding: 2px 8px; border-radius: 99px; font-size: 0.875rem; }
      .topic-group { margin-top: 15px; background: #f4f4f4; border-radius: 8px; padding: 12px; border: 1px solid #f3f4f6; }
      .topic-header { display: flex; align-items: baseline; gap: 6px; font-size: 0.95rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: #374151; margin-bottom: 15px; }      
      .larger { font-size: 1.25rem; font-weight: 700; }
      .item-dpp .topic-header { border-left: 3px solid var(--dpp-primary); padding-left: 8px; }
      .topic-group .data-row { margin-bottom: 12px; }
      .topic-group .data-row:last-child { margin-bottom: 0; }
      .topic-group table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 1rem; line-height: 1.4; }
      .topic-group th { text-align: left; padding: 8px 4px; border-bottom: 2px solid #e5e7eb; color: #6b7280; font-weight: 500; text-transform: uppercase; font-size: 0.95rem; letter-spacing: 0.05em; }   
      .topic-group td { padding: 8px 4px; border-bottom: 1px solid #f3f4f6; color: #111827; }
      .topic-group tr:last-child td { border-bottom: none; }
      .topic-group table badge { color: #ffffff; font-weight: 900; padding: 2px 8px; border-radius: 99px; font-size: 0.875rem; }
      .topic-group td:first-child { font-weight: 500; color: #374151; }
      .topic-group.media-layout { display: flex; flex-direction: column; gap: 12px; }
      .topic-media { width: 100%; }
      .topic-media img { width: 100%; max-height: 300px; object-fit: cover; margin-bottom: 12px; }
      .topic-content { width: 100%; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
      .topic-content .data-row.full-width { grid-column: span 2; }
      .score-container { display: flex; flex-direction: column; align-items: flex-end; width: 100%; margin-top: 2px; bottom: 15px;}
      .score-track { width: 30%; height: 8px; background: #e5e7eb; border-radius: 4px; overflow: hidden; position: relative; }
      .score-fill { height: 100%; border-radius: 4px; transition: width 0.5s ease-in-out; }
      .external-link { color: #2563eb; text-decoration: none; font-weight: 500; display: inline-flex; align-items: center; gap: 4px; border-bottom: 1px solid transparent; transition: all 0.2s ease; font-size: 0.85rem; }
      .external-link:hover { border-bottom: 1px solid #2563eb; color: #1d4ed8; }
      .external-link::after { content: '↗'; font-size: 1rem; font-weight: bold; }
      .item-anchor .external-link { font-family: var(--font-mono); font-size: 0.95rem; }
      .data-row.nested { margin-left: 15px; }
      .data-row.nested .label { flex: 0 0 calc(40% - 25px); font-size: 0.9rem; }
      .data-row.nested .value { flex: 0 0 60%; font-size: 1.12rem; font-weight: 500; }
      .truncate-row { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block; width: 100%; }
      #view-btn { margin-left: auto; background: transparent; color: #688276; border: 1px solid #688276; padding: 2px 8px; font-size: 0.6rem; text-transform: uppercase; border-radius: 0; transition: 0.2s; cursor: pointer; }
      #view-btn:hover { background: var(--dpp-primary); color: #fff; }
      #download-btn { background: transparent; color: #688276; border: 1px solid #688276; padding: 2px 8px; font-size: 0.6rem; text-transform: uppercase; border-radius: 0; transition: 0.2s; margin-left: 8px; cursor: pointer; }
      #download-btn:hover { background: var(--dpp-primary); color: #fff; }
    </style>    
    <title>Digital Product Passport</title>
  </head>
  
  <body>

    <div style="display: flex; gap: 20px; padding: 20px; flex-wrap: wrap">
    <div class="card-viewer">

    <article class="credential-card item-dpp">
      <div class="credential-header">
        <strong>DIGITAL PRODUCT PASSPORT</strong>
      </div>

      <div class="credential-body">
        <div class="topic-group">
          <div class="topic-header">
            <span class="larger">{{credentialSubject.name}}</span>
            <button id="view-btn">View JSON</button>
            <button id="download-btn">Download JSON</button>
          </div>
          <div class="topic-media">
            {{#if credentialSubject.productImage.linkURL}}
              <img src="{{credentialSubject.productImage.linkURL}}" 
                onerror="this.onerror=null;this.src='https://placehold.co/200x150';" 
                alt="Product Image" 
                class="product-main-img">
            {{else}}
              <img src="https://placehold.co/200x150" 
               alt="Placeholder" 
               class="product-main-img">
            {{/if}}
          </div>

          <div class="data-row">
            <span class="label">Product</span>
            <span class="value">{{credentialSubject.name}}</span>
          </div>
          <div class="data-row">
            <span class="label">Manufacturer</span>
            <span class="value">{{credentialSubject.producedByParty.name}}</span>
          </div>
          <div class="data-row">
            <span class="label">Production location</span>
            <span class="value">{{credentialSubject.producedAtFacility.name}} ({{credentialSubject.countryOfProduction}})</span>
          </div>
          <div class="data-row">
            <span class="label">Description</span>
            <span class="value">{{credentialSubject.description}}</span>
          </div>
          <div class="data-row">
            <span class="label">DPP ID</span>
            <span class="value truncate-row">{{credentialSubject.id}}</span>
          </div>
          {{#if credentialSubject.batchNumber}}
            <div class="data-row">
              <span class="label">Batch number</span>
              <span class="value">{{credentialSubject.batchNumber}}</span>
            </div>
          {{/if}}
          {{#if credentialSubject.serialNumber}}
            <div class="data-row">
              <span class="label">Serial number</span>
              <span class="value">{{credentialSubject.serialNumber}}</span>
            </div>
          {{/if}}
          {{#if credentialSubject.productionDate}}
            <div class="data-row">
              <span class="label">Production date</span>
              <span class="value">{{credentialSubject.productionDate}}</span>
            </div>
          {{/if}}
          
          <div class="data-row">
            <span class="label">Dimensions</span>
          </div>
          
          {{#each credentialSubject.dimensions}}
            <div class="data-row nested">
              <span class="label">{{@key}}</span>
              <span class="value"><strong>{{this.value}}</strong> <span>{{this.unit}}</span></span>
            </div>
          {{/each}}

        </div>
                   
        <div class="topic-group">
          <div class="topic-header">Material Provenance</div>
          <table>
            <thead>
              <tr>
                <th>Material</th>
                <th>Mass fraction</th>
                <th>Recycled</th>
                <th>Hazardousity</th>
                <th>Origin</th>
              </tr>
            </thead>
            <tbody>
              {{#each credentialSubject.materialsProvenance}}
                <tr>
                  <td>{{name}}</td>
                  <td>{{multiply massFraction 100}}% ({{massAmount.value}} {{massAmount.unit}})</td>
                  <td>{{multiply recycledAmount 100}}%</td>
                  <td>
                    {{#if (lookup . 'hazardous')}}
                      {{#if hazardous}}
                        <span class="badge hazardous-badge">HAZARDOUS</span>
                      {{else}}
                        <span class="badge safe-badge">SAFE</span>
                      {{/if}}
                    {{else}}
                      <span class="badge unknown-badge">UNKNOWN</span>
                    {{/if}}
                  </td>
                  <td>{{originCountry}}</td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </div>

        {{#if credentialSubject.circularityScorecard}}
        <div class="topic-group">
          <div class="topic-header">Circularity scorecard</div>

          {{#if credentialSubject.circularityScorecard.recycledContent}}
            <div class="data-row">
              <span class="label">Recycled content</span>
              <div class="value score-container">
                <span>{{multiply credentialSubject.circularityScorecard.recycledContent 100}}%</span>
                <div class="score-track">
                  <div class="score-fill {{getScoreMeterClass credentialSubject.circularityScorecard.recycledContent}}" style="width: {{multiply credentialSubject.circularityScorecard.recycledContent 100}}%"></div>
                </div>
              </div>
            </div>              
          {{/if}}
          
          {{#if credentialSubject.circularityScorecard.recyclableContent}}
            <div class="data-row">
              <span class="label">Recyclable content</span>
              <div class="value score-container">
                <span>{{multiply credentialSubject.circularityScorecard.recyclableContent 100}}%</span>
                <div class="score-track">
                  <div class="score-fill {{getScoreMeterClass credentialSubject.circularityScorecard.recyclableContent}}" style="width: {{multiply credentialSubject.circularityScorecard.recyclableContent 100}}%"></div>
                </div>
              </div>         
            </div>
          {{/if}}

          {{#if credentialSubject.circularityScorecard.materialCircularityIndicator}}
            <div class="data-row">
              <span class="label">Circularity indicator</span>
              <div class="value score-container">
                <span>{{multiply credentialSubject.circularityScorecard.materialCircularityIndicator 100}}%</span>
                <div class="score-track">
                  <div class="score-fill {{getScoreMeterClass credentialSubject.circularityScorecard.materialCircularityIndicator}}" style="width: {{multiply credentialSubject.circularityScorecard.materialCircularityIndicator 100}}%"></div>
                </div>
              </div>         
            </div>
          {{/if}}

                    
          {{#if credentialSubject.circularityScorecard.utilityFactor}}
            <div class="data-row">
              <span class="label">Utility factor</span>
              <span class="value">{{credentialSubject.circularityScorecard.utilityFactor}}</span>           
            </div>
          {{/if}}
          
        </div>        
        {{/if}}
     
        <div class="topic-group">
          <div class="topic-header">Circularity</div>
          
          <div class="data-row">
            <span class="label">Recyclability Score</span>
            <div class="value score-container">
              <span>6.5 / 10</span>
              <div class="score-track">
                <div class="score-fill score-mid" style="width: 65%">                  
                </div>
              </div>
            </div>
          </div>
          
          <div class="data-row">
            <span class="label">Repair Score</span>
            <div class="value score-container">
              <span>8.5 / 10</span>
              <div class="score-track">
                <div class="score-fill score-high" style="width: 85%">                  
                </div>
              </div>
            </div>
          </div>

          <div class="data-row">
            <span class="label">Carbon Footprint</span>
            <div class="value score-container">
              <span>3.2 / 10</span>
              <div class="score-track">
                <div class="score-fill score-low" style="width: 32%"></div>
              </div>
            </div>
          </div>  

          <div class="data-row">
            <span class="label">Recycling information</span>
            <span class="value"><a href="https://example.com/Recycling_information.pdf" target="_blank" class="external-link">Recycling_information.pdf</a></span>
          </div>

          <div class="data-row">
            <span class="label">Repair information</span>
            <span class="value"><a href="https://example.com/Repair_information.pdf" target="_blank" class="external-link">Repair_guide.pdf</a></span>
          </div>

        </div>
       
        <div class="topic-group">
          <div class="topic-header">Sustainability metrics</div>
          <div class="data-row">
            <span class="label">GWP (total)</span>
            <span class="value">4.2 tCO2e</span>
          </div>
          <div class="data-row">
            <span class="label">Water intensity</span>
            <span class="value">4 800 l/kg</span>
          </div>
          <div class="data-row">
            <span class="label">Energy mix</span>
            <span class="value">Renewable</span>
          </div>
        </div>
        
      </div>
    </article>
          </div>
        
      </div>
  
  </body>
</html>
